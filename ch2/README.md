# 用語の説明

## リソース
* Puppetにおけるサーバーの状態を宣言する最小の単位
* サーバーが保有するユーザーやファイル、サービスやパッケージなど要素を、仮想的な資源と見なしたもの
* 主要なリソース(Core types)は、[Core types cheat sheet](https://docs.puppet.com/puppet/latest/cheatsheet_core_types.html)を参照

```puppet
リソース名 {タイトル:
  属性,
  属性,
}
```

## 依存関係
* 前提として、Puppetではマニフェストのコンパイル時に最適と考えた実行順でリソースを並び替える (開発者が期待した通りの実行順とは限らない)
* 期待した通りの実行順序(依存関係)を指定できる仕組みがある
* `require`: 指定したリソースが適用された後に、自身のリソースを実行する
* `subscribe`: requireと基本は同じだが、指定したりソースに変更が入った場合は、自身のサービスを再起動する点が異なる

## チェイングアロー (Chaining Arrows)
* 依存関係を指定するための別の記法
* 記述がシンプルだが、複数リソースの依存は記述できないので注意
* `->`: `require`と同じ
* `~>`: `subscribe`と同じ

## マニフェストの実行
* `puppet apply マニフェストファイル名` 
* ドライランにするには、`--noop` オプションをつける

## 変数
* リソースのタイトルや属性などで利用する
* `$変数名`で記述できる
* 一般的なプログラミング言語と異なり、再代入はできない

## 変数のスコープ
* 明示的にスコープを指定しない場合は、近いスコープから遠いスコープへ記述した名称の変数を探す
* グローバルスコープを使用する際は、`::`を使う
* クラス変数を参照する場合も、`::`を使う

## facts変数
* ホスト名やIPアドスなど、システムの操作でよく使う情報を、puppet実行時にあらかじめ格納している変数
* `::`が表すように、グローバルスコープに属する
* facts変数で取得可能な値は、`facter`コマンドで確認できる

## テンプレート
* ファイルのコンテンツのうち、ノード別に設定しなければならない部分を変数で指定し、動的コンテンツを生成するもの
* Puppetで使用するテンプレートの実態は、RubyのERBテンプレートである
* `@変数名`で利用する (`$`ではないので注意)
* スコープの指定ができない (facts変数を使う場合でも`::`なしで記述する)
* テンプレート化したコンテンツの種類2つ
  * 外部のテンプレートファイルを使用する
  * インラインテンプレートファイルを使用する

## ヒアドキュメント (Heredocs)
* 開始する場所には、`@(終端識別子)`、終了する場所には、`|終端識別子` を記述する
* 具体的な説明は、[Language: Data types: Strings](https://docs.puppet.com/puppet/5.3/lang_data_string.html#heredocs)
